(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4988cdf4"],{"57d5":function(e,t,n){"use strict";n("8dab")},"8dab":function(e,t,n){},efbf:function(e,t,n){"use strict";n.r(t);n("a9e3"),n("b0c0");var a=n("7a23"),r=n("9846"),c=n.n(r),o=n("86b5"),s=n.n(o),i=function(e){return Object(a["pushScopeId"])("data-v-4834bf34"),e=e(),Object(a["popScopeId"])(),e},l={class:"order-page"},d={class:"common-back flex-middle"},u={class:"order-content"},f={class:"total-reward flex"},p={class:"flex left-cont"},g={class:"item flex"},m=i((function(){return Object(a["createElementVNode"])("img",{src:c.a,alt:"",class:"icon"},null,-1)})),b={class:"flex-item"},O=i((function(){return Object(a["createElementVNode"])("p",{class:"tit"},"BNX",-1)})),j={class:"num"},w={class:"item flex"},y=i((function(){return Object(a["createElementVNode"])("img",{src:s.a,alt:"",class:"icon"},null,-1)})),v={class:"flex-item"},h={class:"tit"},C={class:"num"},N=i((function(){return Object(a["createElementVNode"])("div",{class:"flex-item flex-middle"},null,-1)})),B={class:"flex-center"},k=i((function(){return Object(a["createElementVNode"])("div",{class:"line-pic"},null,-1)})),x={class:"list"},A={class:"row-item"},D={class:"tit"},E={class:"value"},L={class:"row-item"},V={class:"tit"},G={class:"value Num-font"},X={class:"row-item"},T={class:"tit"},R={class:"value Num-font"},S={class:"row-item"},$={class:"tit"},_={class:"value"},M={class:"row-item"},I={class:"tit"},F={class:"value"},P={key:0,class:"color-F45250"},U={key:1},H={key:2},q={key:0,class:"common-page flex-middle"},z=i((function(){return Object(a["createElementVNode"])("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[Object(a["createElementVNode"])("path",{d:"M3 11.996L9 6L10.41 7.42L6.85 10.976H21V12.976H6.81L10.41 16.58L9 18L3 11.996Z"})],-1)})),J=[z],Z={class:"page-num"},K=i((function(){return Object(a["createElementVNode"])("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},[Object(a["createElementVNode"])("path",{d:"M21 12.004L15 18L13.59 16.58L17.15 13.024H3V11.024H17.19L13.59 7.42L15 6L21 12.004Z"})],-1)})),Q=[K];function W(e,t,n,r,c,o){var s=Object(a["resolveComponent"])("el-button"),i=Object(a["resolveComponent"])("magic-dialog");return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[Object(a["createElementVNode"])("div",l,[Object(a["createElementVNode"])("div",d,[Object(a["createElementVNode"])("div",{class:"back-btn flex-middle",onClick:t[0]||(t[0]=function(t){return e.$router.go(-1)})},Object(a["toDisplayString"])(e.$t("game.返回")),1)]),Object(a["createElementVNode"])("div",u,[Object(a["createElementVNode"])("div",f,[Object(a["createElementVNode"])("div",p,[Object(a["createElementVNode"])("div",g,[m,Object(a["createElementVNode"])("div",b,[O,Object(a["createElementVNode"])("p",j,Object(a["toDisplayString"])(e.reward.coin),1)])]),Object(a["createElementVNode"])("div",w,[y,Object(a["createElementVNode"])("div",v,[Object(a["createElementVNode"])("p",h,Object(a["toDisplayString"])(e.$t("game.Gold")),1),Object(a["createElementVNode"])("p",C,Object(a["toDisplayString"])(e.reward.money),1)])])]),N,Object(a["createElementVNode"])("div",B,[e.needApproveBNX?(Object(a["openBlock"])(),Object(a["createBlock"])(s,{key:0,type:"primary",class:"btn btn-primary-bg",onClick:e.BNXApprove},{default:Object(a["withCtx"])((function(){return[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.$t("game.授權BNX")),1)]})),_:1},8,["onClick"])):e.needApproveGOLD?(Object(a["openBlock"])(),Object(a["createBlock"])(s,{key:1,type:"primary",class:"btn btn-primary-bg",onClick:e.GOLDApprove},{default:Object(a["withCtx"])((function(){return[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.$t("game.授權金幣")),1)]})),_:1},8,["onClick"])):(Object(a["openBlock"])(),Object(a["createBlock"])(s,{key:2,type:"primary",class:"btn btn-primary-bg",disabled:e.disabled,loading:e.disabled,onClick:e.draw},{default:Object(a["withCtx"])((function(){return[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.$t("game.Claim Reward")),1)]})),_:1},8,["disabled","loading","onClick"]))])]),k,Object(a["createElementVNode"])("div",x,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.list,(function(t){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:"row flex",key:t.id},[Object(a["createElementVNode"])("div",A,[Object(a["createElementVNode"])("div",D,Object(a["toDisplayString"])(e.$t("game.寶箱")),1),Object(a["createElementVNode"])("div",E,Object(a["toDisplayString"])(t.chest_name),1)]),Object(a["createElementVNode"])("div",L,[Object(a["createElementVNode"])("div",V,Object(a["toDisplayString"])(e.$t("game.BNX")),1),Object(a["createElementVNode"])("div",G,Object(a["toDisplayString"])(t.r_coin),1)]),Object(a["createElementVNode"])("div",X,[Object(a["createElementVNode"])("div",T,Object(a["toDisplayString"])(e.$t("game.Gold")),1),Object(a["createElementVNode"])("div",R,Object(a["toDisplayString"])(Number(t.r_money)+Number(t.r_bonus_pool)),1)]),Object(a["createElementVNode"])("div",S,[Object(a["createElementVNode"])("div",$,Object(a["toDisplayString"])(e.$t("game.裝備")),1),Object(a["createElementVNode"])("div",_,[t.r_eqs?(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],{key:0},Object(a["renderList"])(t.r_eqs,(function(e){return Object(a["openBlock"])(),Object(a["createElementBlock"])("p",{key:e},Object(a["toDisplayString"])(e.name),1)})),128)):(Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],{key:1},[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.$t("game.None")),1)],64))])]),Object(a["createElementVNode"])("div",M,[Object(a["createElementVNode"])("div",I,Object(a["toDisplayString"])(e.$t("game.Status")),1),Object(a["createElementVNode"])("div",F,[t.r_status?Number(t.r_money)||Number(t.r_coupon)||Number(t.r_coin)?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",H,Object(a["toDisplayString"])(e.$t("game.已領取")),1)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",U,Object(a["toDisplayString"])(e.$t("game.無獎勵")),1)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",P,Object(a["toDisplayString"])(e.$t("game.未領取")),1))])])])})),128))]),e.total&&Math.ceil(e.total/e.limit)>1?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",q,[Object(a["createElementVNode"])("div",{class:Object(a["normalizeClass"])(["prev",{disabled:1===e.page}]),onClick:t[1]||(t[1]=function(){return e.prevPage&&e.prevPage.apply(e,arguments)})},J,2),Object(a["createElementVNode"])("div",Z,Object(a["toDisplayString"])(e.$t("index.第頁共",{page:e.page,total:Math.ceil(e.total/e.limit)})),1),Object(a["createElementVNode"])("div",{class:Object(a["normalizeClass"])(["next",{disabled:e.page===Math.ceil(e.total/e.limit)}]),onClick:t[2]||(t[2]=function(){return e.nextPage&&e.nextPage.apply(e,arguments)})},Q,2)])):Object(a["createCommentVNode"])("",!0)])]),Object(a["createVNode"])(i,{showMagic:e.showMagic,"onUpdate:showMagic":t[3]||(t[3]=function(t){return e.showMagic=t}),magicInfo:e.magicInfo,address:e.address,onUseMagic:e.useMagic,onEndCast:e.endCast},null,8,["showMagic","magicInfo","address","onUseMagic","onEndCast"])],64)}var Y=n("5530"),ee=n("1da1"),te=(n("96cf"),n("d3b7"),n("159b"),n("01ea")),ne=n("5502"),ae=n("47e2"),re=n("7068"),ce=n("4995"),oe=n("541a"),se=n("722f"),ie=n("901e"),le=n.n(ie),de=n("9d56"),ue=n("5f3d"),fe={components:{MagicDialog:ue["a"]},setup:function(){var e=Object(a["getCurrentInstance"])(),t=e.proxy,n=Object(ne["b"])(),r=Object(ae["b"])(),c=r.t,o=Object(a["reactive"])({config:te["a"],address:Object(a["computed"])((function(){return n.state.accounts})),web3:Object(a["computed"])((function(){return n.state.provider})),list:[],page:1,limit:20,total:0,reward:{},disabled:!1,userBalance:0,GOLDBalance:0,BNXBalance:0,BNXAllowance:0,GOLDAllowance:0,feeContract:null,BNXContract:null,GOLDContract:null,feeConfig:[],addrConfig:[],paymentType:"",needApproveBNX:!1,needApproveGOLD:!1,feeType:202,showMagic:!1,magicDisabled:!1,magicInfo:{},initContract:function(){o.web3.eth.getBalance(o.address).then((function(e){o.userBalance=e})),o.feeContract=new o.web3.eth.Contract(oe,te["a"].FeeAddress),o.BNXContract=new o.web3.eth.Contract(se,te["a"].BscAddress),o.GOLDContract=new o.web3.eth.Contract(se,te["a"].NewtokenAddress),o.getBalance(),o.getBNXAllowance(),o.getGOLDAllowance(),o.getPaymentTypeFun(),o.getReward(),o.getList()},getPaymentTypeFun:function(){var e=Object(ee["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o.feeContract.methods.getFeeConfig(o.feeType).call();case 2:return o.feeConfig=e.sent,e.next=5,o.feeContract.methods.getAddrConfig(o.feeType).call();case 5:o.addrConfig=e.sent,"0x0000000000000000000000000000000000000000"===o.addrConfig[0]&&"0x0000000000000000000000000000000000000000"===o.addrConfig[1]?(o.paymentType="1",o.needApproveBNX=!1,o.needApproveGOLD=!1):"0x0000000000000000000000000000000000000000"!==o.addrConfig[0]&&"0x0000000000000000000000000000000000000000"===o.addrConfig[1]?(o.paymentType="2",o.addrConfig[0]===te["a"].BscAddress&&new le.a(o.BNXAllowance).lt(o.feeConfig[0])&&(o.needApproveBNX=!0),o.addrConfig[0]===te["a"].NewtokenAddress&&new le.a(o.GOLDAllowance).lt(o.feeConfig[0])&&(o.needApproveGOLD=!0)):"0x0000000000000000000000000000000000000000"===o.addrConfig[0]&&"0x0000000000000000000000000000000000000000"!==o.addrConfig[1]?(o.paymentType="3",o.addrConfig[1]===te["a"].BscAddress&&new le.a(o.BNXAllowance).lt(o.feeConfig[1])&&(o.needApproveBNX=!0),o.addrConfig[1]===te["a"].NewtokenAddress&&new le.a(o.GOLDAllowance).lt(o.feeConfig[1])&&(o.needApproveGOLD=!0)):"0x0000000000000000000000000000000000000000"!==o.addrConfig[0]&&"0x0000000000000000000000000000000000000000"!==o.addrConfig[1]&&(o.paymentType="4",o.addrConfig.forEach((function(e,t){e===te["a"].BscAddress&&new le.a(o.BNXAllowance).lt(o.feeConfig[t])&&(o.needApproveBNX=!0),e===te["a"].NewtokenAddress&&new le.a(o.GOLDAllowance).lt(o.feeConfig[t])&&(o.needApproveGOLD=!0)})));case 7:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getBalance:function(){var e=Object(ee["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o.GOLDContract.methods.balanceOf(o.address).call();case 2:return o.GOLDBalance=e.sent,e.next=5,o.BNXContract.methods.balanceOf(o.address).call();case 5:o.BNXBalance=e.sent;case 6:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getBNXAllowance:function(){var e=Object(ee["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o.BNXContract.methods.allowance(o.address,te["a"].FeeAddress).call();case 2:t=e.sent,o.BNXAllowance=t,o.needApproveBNX=!1;case 5:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),BNXApprove:function(){var e=Object(ee["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o.address){e.next=3;break}return re["a"].error({title:c("index.連線錢包")}),e.abrupt("return");case 3:o.BNXContract.methods.approve(te["a"].FeeAddress,de["a"]).send({from:o.address}).then((function(){o.getBNXAllowance()}));case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),getGOLDAllowance:function(){var e=Object(ee["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o.GOLDContract.methods.allowance(o.address,te["a"].FeeAddress).call();case 2:t=e.sent,o.GOLDAllowance=t,o.needApproveGOLD=!1;case 5:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),GOLDApprove:function(){var e=Object(ee["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o.address){e.next=3;break}return re["a"].error({title:c("index.連線錢包")}),e.abrupt("return");case 3:o.GOLDContract.methods.approve(te["a"].FeeAddress,de["a"]).send({from:o.address}).then((function(){o.getGOLDAllowance()}));case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),draw:function(){var e=Object(ee["a"])(regeneratorRuntime.mark((function e(){var n,a,r,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o.address){e.next=3;break}return re["a"].error({title:c("index.連線錢包")}),e.abrupt("return");case 3:if(o.addrConfig.length){e.next=6;break}return re["a"].error({title:c("game.系統操作頻繁，請稍後")}),e.abrupt("return");case 6:if("1"!==o.paymentType&&"3"!==o.paymentType||!new le.a(o.userBalance).lt(o.feeConfig[0])){e.next=9;break}return re["a"].error({title:c("game.手續費不足")}),e.abrupt("return");case 9:if("2"!==o.paymentType){e.next=16;break}if(o.addrConfig[0]!==te["a"].BscAddress||!new le.a(o.BNXBalance).lt(o.feeConfig[0])){e.next=13;break}return re["a"].error({title:c("game.BNX餘額不足")}),e.abrupt("return");case 13:if(o.addrConfig[0]!==te["a"].NewtokenAddress||!new le.a(o.GOLDBalance).lt(o.feeConfig[0])){e.next=16;break}return re["a"].error({title:c("game.金幣餘額不足")}),e.abrupt("return");case 16:if("3"!==o.paymentType){e.next=23;break}if(o.addrConfig[1]!==te["a"].BscAddress||!new le.a(o.BNXBalance).lt(o.feeConfig[1])){e.next=20;break}return re["a"].error({title:c("game.BNX餘額不足")}),e.abrupt("return");case 20:if(o.addrConfig[1]!==te["a"].NewtokenAddress||!new le.a(o.GOLDBalance).lt(o.feeConfig[1])){e.next=23;break}return re["a"].error({title:c("game.金幣餘額不足")}),e.abrupt("return");case 23:if("4"!==o.paymentType){e.next=33;break}for(n=!1,a=!1,r=0;r<o.addrConfig.length;r++)s=o.addrConfig[r],i=r,s===te["a"].BscAddress&&new le.a(o.BNXBalance).lt(o.feeConfig[i])&&(n=!0),s===te["a"].NewtokenAddress&&new le.a(o.GOLDBalance).lt(o.feeConfig[i])&&(a=!0);if(!n){e.next=30;break}return re["a"].error({title:c("game.BNX餘額不足")}),e.abrupt("return");case 30:if(!a){e.next=33;break}return re["a"].error({title:c("game.金幣餘額不足")}),e.abrupt("return");case 33:o.disabled=!0,t.$http.post(t.$dungeonURL+"/v1/chest/draw",{GoldAddress:o.address}).then((function(e){ce["a"].success({message:c("game.Claimed successfully"),type:"success",offset:240}),o.getReward(),o.getList(),o.payGas(e.data.uuid)})).catch((function(e){o.disabled=!1,console.log(e)}));case 35:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}(),payGas:function(){var e=Object(ee["a"])(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("1"!==o.paymentType){e.next=8;break}return e.next=3,o.feeContract.methods.paymentBnb(t,o.feeType).estimateGas({from:o.address,value:o.feeConfig[0]});case 3:n=e.sent,console.log("gas",n),o.feeContract.methods.paymentBnb(t,o.feeType).send({from:o.address,value:o.feeConfig[0]}).then((function(e){o.disabled=!1,ce["a"].success({message:c("game.手續費支付成功"),type:"success",offset:240})})).catch((function(e){o.disabled=!1,console.log(e),re["a"].error({title:c("game.手續費支付失敗")})})),e.next=21;break;case 8:if("2"!==o.paymentType){e.next=12;break}o.feeContract.methods.paymentCoin(t,o.feeType,o.addrConfig[0],o.feeConfig[0]).send({from:o.address}).then((function(e){o.disabled=!1,ce["a"].success({message:c("game.手續費支付成功"),type:"success",offset:240})})).catch((function(e){o.disabled=!1,console.log(e),re["a"].error({title:c("game.手續費支付失敗")})})),e.next=21;break;case 12:if("3"!==o.paymentType){e.next=20;break}return e.next=15,o.feeContract.methods.paymentMulBnb(t,o.feeType,o.addrConfig[1],o.feeConfig[1]).estimateGas({from:o.address,value:o.feeConfig[0]});case 15:a=e.sent,console.log("gas",a),o.feeContract.methods.paymentMulBnb(t,o.feeType,o.addrConfig[1],o.feeConfig[1]).send({from:o.address,value:o.feeConfig[0]}).then((function(e){o.disabled=!1,ce["a"].success({message:c("game.手續費支付成功"),type:"success",offset:240})})).catch((function(e){o.disabled=!1,console.log(e),re["a"].error({title:c("game.手續費支付失敗")})})),e.next=21;break;case 20:"4"===o.paymentType&&o.feeContract.methods.paymentMulCoin(t,o.feeType,o.addrConfig[0],o.feeConfig[0],o.addrConfig[1],o.feeConfig[1]).send({from:o.address}).then((function(e){o.disabled=!1,ce["a"].success({message:c("game.手續費支付成功"),type:"success",offset:240})})).catch((function(e){o.disabled=!1,console.log(e),re["a"].error({title:c("game.手續費支付失敗")})}));case 21:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),getReward:function(){t.$http.post(t.$dungeonURL+"/v1/chest/wallet",{GoldAddress:o.address}).then((function(e){o.reward={money:e.data.money,coin:e.data.coin,coupon:e.data.coupon}}))},getList:function(){t.$http.post(t.$dungeonURL+"/v1/chest/loglist",{Page:o.page,GoldAddress:o.address,Limit:o.limit}).then((function(e){o.list=e.data.Lists,o.total=e.data.TotalAmount}))},prevPage:function(){1!==o.page&&(o.page--,o.getList())},nextPage:function(){o.page!==Math.ceil(o.total/o.limit)&&(o.page++,o.getList())},magichouseSign:function(){o.magicDisabled=!0,t.$http.post(t.$dungeonURL+"/v1/user/getaddressnonce",{GoldAddress:o.address}).then((function(e){var t=e.data.nonce+"";o.web3.eth.personal.sign(o.web3.utils.utf8ToHex(t),o.address,"password").then((function(e){var n=e;o.magichouseBegin(n,t)})).catch((function(){o.magicDisabled=!1}))})).catch((function(){o.magicDisabled=!1}))},magichouseBegin:function(e,n){o.magicDisabled=!0,t.$http.post(t.$dungeonURL+"/v1/magichouse/begin",{GoldAddress:o.address,ASign:e,Nonce:n,FromType:2}).then((function(e){o.magicDisabled=!1,o.showMagic=!0,o.magicInfo=e.data})).catch((function(){o.magicDisabled=!1}))},useMagic:function(e){console.log(e),o.magicInfo.ln=e.ln,o.magicInfo.sn=e.sn,o.magicInfo.fn=e.fn,o.magicInfo.r_r=e.r_r,o.magicInfo.r_coupon=e.r_coupon,o.magicInfo.r_money=e.r_money,o.magicInfo.r_coin=e.r_coin},endCast:function(){o.showMagic=!1,o.getReward(),ce["a"].success({message:c("game.施法結束"),type:"success",offset:240})}});o.address&&o.initContract(),Object(a["watch"])((function(){return o.address}),(function(e){e&&o.initContract()}));var s=Object(a["toRefs"])(o);return Object(Y["a"])({},s)}},pe=(n("57d5"),n("6b0d")),ge=n.n(pe);const me=ge()(fe,[["render",W],["__scopeId","data-v-4834bf34"]]);t["default"]=me}}]);